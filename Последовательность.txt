@startuml

== Ввод в адресную строку браузера ==

Actor Пользователь

Пользователь -> Браузер: Ввод адреса google.com

Activate Браузер

== Проверка кэша DNS, чтобы найти соответствующй IP адрес ==

group Поиск IP адреса

Браузер -> Кэш_браузера: Поиск DNS для введённого адреса

Activate Кэш_браузера

Кэш_браузера --> Браузер: Ответ на запрос

Deactivate Кэш_браузера

alt Если не нашлось в кэше браузера

Браузер -> Кэш_ОС: Системный вызов gethostname для поиска DNS

Activate Кэш_ОС

Кэш_ОС -> Браузер: Ответ на запрос

Deactivate Кэш_ОС

end

alt Если не нашлось в кэше ОС

Браузер -> Кэш_маршрутизатора: Поиск DNS в кэше маршрутизатора

Activate Кэш_маршрутизатора

Кэш_маршрутизатора --> Браузер: Ответ на запрос

Deactivate Кэш_маршрутизатора

end

== Рекурсивный поиск IP-адреса на DNS серверах ==

alt Если не нашлось в кэше маршрутизатора

Браузер -> DNS_сервер_провайдера: Поиск DNS в кэше провайдера

Activate DNS_сервер_провайдера

DNS_сервер_провайдера -> Сервера_имён: Поиск IP адреса по указанному домену

Activate Сервера_имён

Сервера_имён --> Браузер: IP адрес найден

alt Если IP адрес не найден

Сервера_имён x--> DNS_сервер_провайдера: IP адрес не найден

DNS_сервер_провайдера --> Браузер: Ошибка "Не удалось найти IP адрес сервера"

end

Deactivate Сервера_имён

Deactivate DNS_сервер_провайдера

end

end

== TCP-соединение с сервером ==

Компьютер -> Сервер_гугла: Отправляет пакет SYN (синхронизация)

Activate Сервер_гугла

Activate Компьютер

Сервер_гугла --> Компьютер: Отвечает пакетом ACK (потдверждение)

Сервер_гугла <--> Компьютер: TCP соединение установлено

Компьютер -> Браузер: TCP-соединение установлено

alt Если TCP-соединение не установлено

Сервер_гугла x--> Компьютер: Сервер не имеет открытых портов

Компьютер --> Браузер: Ошибка "Соединение не установлено"

Deactivate Компьютер

end

== HTTP запрос на веб-сервер ==

Браузер -> Сервер_гугла: GET запрос на google.com

note left

**Пример GET-запроса**

GET /страница HTTP/1.1

Host: www.google.com

User-Agent: Mozilla/5.0

(X11; U; Linux i686; ru; rv:1.9b5)

Gecko/2008050509 Firefox/3.0b5

Accept: text/html

Connection: close

---------------------------------

Если вводить учётные данные

или отправлять форму

то будет отправлен POST запрос

end note



== Ответ сервера HTTP ==

Сервер_гугла --> Браузер: Ответ сервера

note left

**Пример ответа HTTP-сервера**

HTTP/**1.1** 200 OK

Date: Wed, 11 Feb 2009 11:20:59 GMT

Server: Apache

X-Powered-By: PHP/5.2.4-2ubuntu5wm1

Last-Modified: Wed, 11 Feb 2009 11:20:59 GMT

Content-Language: ru

Content-Type: text/html; charset=utf-8

Content-Length: 1234

Connection: close

end note

group Типы статуса ответа

Сервер_гугла --> Браузер:  1xx обозначает только информационное сообщение

Сервер_гугла --> Браузер:  2xx указывает на какой-то успех

Сервер_гугла --> Браузер:  3xx перенаправляет клиента на другой URL

Сервер_гугла --> Браузер:  4xx указывает на ошибку со стороны клиента

Сервер_гугла --> Браузер:  5xx указывает на ошибку со стороны сервера

end

== Отображение HTML-контента браузером==

Браузер -> Браузер: Отображает скелет HTML

Браузер -> Сервер_гугла: GET-запрос на дополнительные элементы

Сервер_гугла --> Браузер: получает ответ на GET-запрос

Deactivate Сервер_гугла

Браузер -> Кэш_браузера: Кэширование статических файлов сайта

Браузер -> Браузер: Отображает страницу со всеми элементами

@enduml